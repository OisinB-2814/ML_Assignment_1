LDA\_OB
================

1.  Import the necessary packages

``` r
library(klaR)
library(tidyverse)
library(caret)
library(MASS)
library(scales)
theme_set(theme_classic())
```

1.  Import the training dataset and clean

``` r
beers_train <- read.table("C:/Users/Oisin/Desktop/ML Assignment 1/Data/beer_training.txt")

colnames(beers_train) <- c('calorific_value', 'nitrogen', 'turbidity', 'style', 'alcohol', 'sugars', 'bitterness', 'beer_id', 'colour', 'degree_of_fermentation')

rownames(beers_train) <- beers_train$beer_id

beers_train <- arrange(beers_train,by=style)

beers_train <- beers_train %>% relocate(style)

beers_train <- subset(beers_train, select = -c(beer_id))

beers_train
```

    ##     style calorific_value  nitrogen turbidity  alcohol sugars bitterness
    ## 1     ale        45.30531 0.4595482 1.9172727 4.227692  16.67  12.568947
    ## 2     ale        43.88938 0.5489770 3.1863636 4.289231  16.73  14.974000
    ## 3     ale        41.58850 0.5428470 1.5681818 4.344615  16.48  11.848789
    ## 4     ale        44.55310 0.4803009 1.8718182 4.424615  18.59  13.879632
    ## 5     ale        41.01327 0.4418605 2.3454545 4.264615  16.35  12.186053
    ## 6     ale        42.78319 0.3604634 1.8890909 4.172308  16.71  15.093737
    ## 7     ale        44.77434 0.4319595 1.1418182 4.218462  16.86  12.822737
    ## 8     ale        44.15487 0.4934468 2.4436364 4.252308  16.75  14.172947
    ## 9     ale        37.60619 0.4854801 2.5545455 4.338462  17.02  13.262526
    ## 10    ale        45.83628 0.5208624 1.8863636 4.230769  16.73  11.503368
    ## 11    ale        44.95133 0.5863655 2.2645455 4.369231  16.76  14.824789
    ## 12    ale        40.26106 0.6095854 2.3463636 4.421538  16.95  11.819000
    ## 13    ale        37.42920 0.4292474 2.2409091 4.378462  16.71  10.012316
    ## 14    ale        44.46460 0.3630744 1.8145455 4.147692  16.81   9.659053
    ## 15    ale        37.73894 0.5713865 1.6590909 4.427692  16.87  12.812000
    ## 16    ale        43.44690 0.5733242 2.8627273 4.221538  16.43  13.745421
    ## 17    ale        41.67699 0.2954211 1.8145455 4.375385  18.99  10.318737
    ## 18    ale        44.77434 0.4501766 1.6054545 4.372308  19.04  13.320263
    ## 19    ale        45.21681 0.7427743 2.8536364 4.366154  16.59  12.498789
    ## 20    ale        37.51770 0.4354854 1.8127273 4.172308  16.73  10.670632
    ## 21    ale        43.09292 0.3354138 1.7545455 4.196923  18.10  11.077211
    ## 22    ale        42.11947 0.3910880 1.3690909 3.953846  16.60  10.241737
    ## 23    ale        44.06637 0.4540880 2.1245455 4.270769  16.89  11.193895
    ## 24    ale        45.03982 0.5321716 1.7563636 4.326154  17.15  11.623105
    ## 25    ale        40.21681 0.5052854 1.3554545 4.120000  16.77  13.745579
    ## 26    ale        38.26991 0.4899209 1.6254545 4.015385  16.65   9.954053
    ## 27    ale        44.02212 0.4956295 2.2800000 4.255385  16.57  14.013684
    ## 28    ale        44.42035 0.3824154 1.0900000 4.153846  16.81   9.406789
    ## 29    ale        38.84513 0.5624364 2.2563636 4.255385  16.65  10.426895
    ## 30    ale        41.45575 0.5540157 2.2518182 4.089231  16.97  10.486684
    ## 31    ale        38.18142 0.5052529 2.1327273 4.224615  16.50  10.180263
    ## 32    ale        40.65929 0.4646229 1.1872727 4.156923  16.80  12.579842
    ## 33    ale        39.28761 0.5513722 1.5836364 4.233846  16.53   8.651895
    ## 34    ale        44.90708 0.4751252 1.5754545 4.049231  17.36  14.359789
    ## 35    ale        43.62389 0.3490822 1.4463636 3.978462  18.80   9.628895
    ## 36    ale        44.50885 0.5757227 2.0309091 4.236923  16.90  12.543737
    ## 37    ale        38.18142 0.5817449 1.9845455 4.400000  16.92  10.523474
    ## 38    ale        38.04867 0.5612046 2.8145455 4.193846  16.81  12.494684
    ## 39    ale        39.28761 0.3836507 1.3163636 4.267692  16.90   9.522789
    ## 40    ale        38.71239 0.3083511 1.6509091 4.073846  17.59  12.602158
    ## 41    ale        37.96018 0.3972146 2.1427273 4.086154  16.64  11.255368
    ## 42    ale        41.85398 0.3120535 1.0818182 4.015385  17.05  10.781684
    ## 43  lager        41.94248 0.1832299 1.4118182 3.806154  16.17   7.673684
    ## 44  lager        38.53540 0.2570811 1.2509091 3.876923  16.34   6.847579
    ## 45  lager        44.55310 0.2190268 0.9390909 3.636923  16.47   6.328421
    ## 46  lager        45.52655 0.1894645 1.7509091 3.889231  16.36   6.581526
    ## 47  lager        45.70354 0.1375965 0.8918182 3.760000  16.29  10.271368
    ## 48  lager        39.90708 0.1070127 0.7790909 3.692308  15.92   7.479684
    ## 49  lager        41.58850 0.3411224 1.4690909 3.781538  16.61   6.477789
    ## 50  lager        42.03097 0.2824538 1.7081818 3.913846  16.81  12.106158
    ## 51  lager        40.34956 0.1971467 0.6290909 3.904615  16.53   5.315474
    ## 52  lager        44.11062 0.2064823 1.3527273 3.898462  15.98   8.277158
    ## 53  lager        40.17257 0.1412989 0.6909091 3.393846  16.51   9.779632
    ## 54  lager        38.18142 0.1690965 1.4527273 3.824615  16.53  13.817632
    ## 55  lager        43.53540 0.1833697 1.5800000 4.150769  16.66   7.230316
    ## 56  lager        38.53540 0.2867161 1.2590909 3.793846  16.10   4.326368
    ## 57  lager        38.97788 0.1672993 0.2909091 3.806154  16.63  10.858158
    ## 58  lager        40.74779 0.1094106 1.5418182 3.575385  16.99  11.216526
    ## 59  lager        42.29646 0.1275198 1.4318182 3.821538  17.55   9.598737
    ## 60  lager        37.87168 0.2383387 0.6727273 3.716923  16.33   5.665842
    ## 61  lager        44.46460 0.2053909 0.6627273 3.716923  16.83   5.123684
    ## 62  lager        37.38496 0.1760770 1.1309091 3.741538  16.61   9.554789
    ## 63  lager        45.08407 0.3900271 0.8472727 3.680000  16.09  11.423474
    ## 64  lager        40.08407 0.1649775 0.5345455 3.907692  18.87   9.168158
    ## 65  lager        41.94248 0.3527811 0.7727273 4.104615  15.94   5.924737
    ## 66  lager        41.41150 0.2024304 0.9590909 3.692308  16.51   6.085526
    ## 67  lager        38.80088 0.2833306 1.2654545 3.704615  19.30   6.477632
    ## 68  lager        41.76549 0.1436587 1.1181818 3.652308  19.31   9.866684
    ## 69  lager        38.93363 0.1949253 0.7581818 3.796923  17.45  11.172579
    ## 70  lager        40.96903 0.2464424 0.7018182 3.523077  17.40  10.438474
    ## 71  lager        45.26106 0.1384795 0.8645455 3.716923  16.39  11.467421
    ## 72  lager        43.35841 0.3118376 0.9281818 3.581538  17.06   6.081105
    ## 73  lager        41.41150 0.1940444 0.7700000 3.510769  15.74   7.862579
    ## 74  lager        42.78319 0.2874545 0.6500000 3.716923  16.13   4.950632
    ## 75  lager        43.35841 0.1444331 1.2227273 3.744615  16.45  10.372368
    ## 76  lager        37.34071 0.2656111 1.2027273 3.806154  16.21   9.162368
    ## 77  lager        39.46460 0.1979931 0.6190909 3.643077  15.89  11.745737
    ## 78  lager        43.04867 0.1976727 1.2290909 4.264615  16.51  13.655474
    ## 79  lager        37.07522 0.3962312 0.7381818 3.996923  16.67  11.748474
    ## 80  lager        39.90708 0.2416840 1.1554545 3.584615  16.67   6.359421
    ## 81  lager        38.75664 0.2502493 0.7936364 3.572308  16.35  13.315158
    ## 82  lager        39.59735 0.1802660 0.8563636 3.821538  19.43   9.708263
    ## 83  lager        38.18142 0.1962298 0.9409091 3.627692  17.13  11.259789
    ## 84  lager        43.49115 0.2585980 1.1390909 3.633846  17.12   8.174263
    ## 85  lager        38.09292 0.2615219 1.7318182 3.618462  17.68   7.556158
    ## 86  lager        45.70354 0.2241700 2.6618182 3.556923  17.05  20.063789
    ## 87  stout        37.65044 0.2446812 2.4136364 3.870769  16.29   3.219053
    ## 88  stout        38.62389 0.2938689 3.0018182 3.876923  17.46   2.730211
    ## 89  stout        37.42920 0.3590551 1.1945455 4.049231  18.57   4.336579
    ## 90  stout        44.59735 0.3947475 2.4854545 3.769231  18.88   4.523263
    ## 91  stout        41.01327 0.2671232 2.0127273 4.150769  18.59   6.593263
    ## 92  stout        44.02212 0.1698031 1.3118182 4.270769  20.04   6.159263
    ## 93  stout        43.04867 0.2685709 3.9809091 3.944615  18.37   7.098632
    ## 94  stout        43.93363 0.2545821 2.4518182 3.849231  16.24   5.219053
    ## 95  stout        44.42035 0.2956987 3.5036364 4.240000  17.76   7.318526
    ## 96  stout        38.35841 0.2821708 4.2554545 4.070769  18.30   4.046684
    ## 97  stout        44.68584 0.1858375 2.8372727 4.224615  19.36   6.667526
    ## 98  stout        45.57080 0.1687477 3.9899996 3.929231  17.39   6.265211
    ## 99  stout        44.42035 0.3319958 3.5490909 4.083077  19.28   4.823211
    ## 100 stout        42.47345 0.2968294 2.9027273 4.052308  20.19   3.847737
    ## 101 stout        45.34956 0.2801611 1.8009091 3.956923  16.35   4.348684
    ## 102 stout        40.92478 0.2568693 1.6500000 4.190769  19.95   7.374737
    ## 103 stout        40.03982 0.3030674 1.6863636 4.110769  17.56   3.550000
    ## 104 stout        43.13717 0.2052864 2.6118182 3.803077  18.83   3.167789
    ## 105 stout        42.73894 0.2594444 2.9618182 4.098462  18.24   5.145474
    ## 106 stout        43.93363 0.2488701 2.3100000 3.753846  18.03   3.413737
    ## 107 stout        42.82743 0.2053909 3.2263636 4.258462  19.12   7.099316
    ## 108 stout        42.82743 0.3137753 2.3600000 3.987692  18.45   3.801579
    ## 109 stout        38.44690 0.2301990 2.3081818 3.907692  18.55   8.877895
    ## 110 stout        44.68584 0.3349204 3.6518182 4.052308  17.59   5.002737
    ## 111 stout        41.14602 0.2708221 1.7427273 3.941538  17.31   5.800053
    ## 112 stout        41.45575 0.2625419 3.0181818 4.024615  18.90   9.466895
    ## 113 stout        43.04867 0.1802694 4.0472727 3.935385  17.67   5.900211
    ## 114 stout        43.84513 0.3112757 3.0500000 4.218462  20.65   5.469947
    ## 115 stout        42.03097 0.2459815 1.5436364 3.963077  17.99   8.782000
    ## 116 stout        44.95133 0.3049691 2.7445455 4.123077  18.91   6.272368
    ## 117 stout        38.18142 0.2632152 1.8281818 4.212308  18.26   5.262316
    ## 118 stout        40.88053 0.2928461 3.7172727 4.356923  17.51   4.064737
    ## 119 stout        37.51770 0.2375283 3.1218182 3.960000  19.61   3.751842
    ## 120 stout        41.05752 0.3101124 1.4400000 3.769231  19.72   5.720158
    ## 121 stout        41.50000 0.2758608 2.2290909 3.953846  18.27   4.228421
    ## 122 stout        43.71239 0.2332966 2.6272727 4.153846  18.12   6.288053
    ## 123 stout        38.13717 0.3287150 3.7536364 4.138462  18.70   7.799368
    ## 124 stout        42.51770 0.3526441 2.9372727 3.830769  18.03   6.692737
    ##     colour degree_of_fermentation
    ## 1   11.040               62.17857
    ## 2   13.440               63.03286
    ## 3   14.040               63.46857
    ## 4   12.480               63.53143
    ## 5   12.120               63.74714
    ## 6   11.400               63.91286
    ## 7   13.320               64.03429
    ## 8   12.120               65.62571
    ## 9   12.840               65.82857
    ## 10  13.800               66.47000
    ## 11  12.600               66.75000
    ## 12  10.320               67.55714
    ## 13  12.480               67.81000
    ## 14  12.480               67.89857
    ## 15  12.240               67.95000
    ## 16  10.680               68.07143
    ## 17  10.680               68.42714
    ## 18  10.440               68.45143
    ## 19  14.760               68.67429
    ## 20  11.760               69.16286
    ## 21  11.520               69.43429
    ## 22  13.080               69.95429
    ## 23  10.560               70.21571
    ## 24  12.720               70.87000
    ## 25  11.040               70.88286
    ## 26  13.440               70.99286
    ## 27  13.560               71.05429
    ## 28  13.440               71.47000
    ## 29  14.880               71.54286
    ## 30  12.840               72.56000
    ## 31  14.280               73.10000
    ## 32  13.200               73.17857
    ## 33  15.000               73.21429
    ## 34  12.360               73.43286
    ## 35  12.360               74.06429
    ## 36  13.560               74.18857
    ## 37  12.840               74.35429
    ## 38  15.360               75.67143
    ## 39  15.000               75.82857
    ## 40  12.480               78.14714
    ## 41  13.080               78.70857
    ## 42  13.560               87.02571
    ## 43  13.440               53.66857
    ## 44  12.480               54.01429
    ## 45  11.400               54.53000
    ## 46  11.760               54.91143
    ## 47  10.320               54.95143
    ## 48  16.560               55.91429
    ## 49  10.872               60.89857
    ## 50  13.920               61.05714
    ## 51  11.520               61.59143
    ## 52  14.760               61.62286
    ## 53  20.520               61.91429
    ## 54   8.280               61.94429
    ## 55  11.760               62.30857
    ## 56  15.000               62.56000
    ## 57  10.680               62.64286
    ## 58  13.920               63.30286
    ## 59  10.320               63.34714
    ## 60  12.840               63.41429
    ## 61  12.960               63.44000
    ## 62  15.960               64.65571
    ## 63  11.880               64.72857
    ## 64  14.280               65.80000
    ## 65  12.240               65.94857
    ## 66  12.600               66.08286
    ## 67   9.480               66.17429
    ## 68   9.000               66.27286
    ## 69   9.600               67.04857
    ## 70   9.600               67.34000
    ## 71  11.160               67.55714
    ## 72  12.000               67.84857
    ## 73  13.200               68.72857
    ## 74  15.720               68.91286
    ## 75  17.400               70.13857
    ## 76  14.280               70.23429
    ## 77   9.480               70.68857
    ## 78  16.320               73.00429
    ## 79  15.720               73.02857
    ## 80  16.320               73.16857
    ## 81  11.520               73.98571
    ## 82  11.040               74.42429
    ## 83  11.640               76.31714
    ## 84  11.400               76.78000
    ## 85  14.760               81.21143
    ## 86  11.160               87.23857
    ## 87   6.960               57.21429
    ## 88   8.760               60.37143
    ## 89   7.200               60.70714
    ## 90   7.800               60.88571
    ## 91   9.720               61.93000
    ## 92   6.960               62.03857
    ## 93   8.640               62.47143
    ## 94   9.000               62.60714
    ## 95   8.400               62.61429
    ## 96   6.720               62.84571
    ## 97   9.360               62.84857
    ## 98   6.840               62.93143
    ## 99   7.080               62.93429
    ## 100  7.200               63.66857
    ## 101  9.120               63.66857
    ## 102 10.920               63.90714
    ## 103  8.400               64.10714
    ## 104  6.720               64.31714
    ## 105  6.600               64.46000
    ## 106  7.920               65.15429
    ## 107  6.840               65.23143
    ## 108  8.160               65.33571
    ## 109  9.360               65.43429
    ## 110  7.200               65.64714
    ## 111  7.920               65.85714
    ## 112  6.840               66.57714
    ## 113  5.760               67.10286
    ## 114  7.680               67.15000
    ## 115  8.880               67.51429
    ## 116  8.400               68.16000
    ## 117 11.520               68.80857
    ## 118  7.440               69.30286
    ## 119  6.480               69.70286
    ## 120  9.000               70.23714
    ## 121 10.440               70.68857
    ## 122  7.080               70.94000
    ## 123 10.200               71.17143
    ## 124  8.040               71.45143

1.  Import the test dataset and clean

``` r
beers_test <- read.table("C:/Users/Oisin/Desktop/ML Assignment 1/Data/beer_test.txt")

colnames(beers_test) <- c('calorific_value', 'nitrogen', 'turbidity', 'style', 'alcohol', 'sugars', 'bitterness', 'beer_id', 'colour', 'degree_of_fermentation')

rownames(beers_test) <- beers_test$beer_id

beers_test <- arrange(beers_test,by=style)

beers_test <- beers_test %>% relocate(style)

beers_test <- subset(beers_test, select = -c(beer_id))

beers_test
```

    ##    style calorific_value  nitrogen turbidity  alcohol sugars bitterness
    ## 1    ale        41.72124 0.5032758 2.6281818 4.015385  16.73  10.452789
    ## 2    ale        42.42920 0.5255122 1.7763636 4.092308  16.72  10.999526
    ## 3    ale        45.88053 0.4432328 2.6281818 4.276923  16.68  13.456368
    ## 4    ale        45.30531 0.4716678 1.8063636 4.126154  18.84   9.202737
    ## 5    ale        38.97788 0.3928458 2.2727273 4.015385  16.77   9.457895
    ## 6    ale        41.14602 0.3964436 0.8854545 4.021538  16.50  13.026105
    ## 7    ale        45.39381 0.4661716 1.9809091 4.563077  16.64  11.448526
    ## 8    ale        38.26991 0.4724782 2.0990909 4.313846  16.68  12.328263
    ## 9    ale        43.53540 0.4358709 1.3427273 4.061538  16.78  10.819158
    ## 10   ale        37.29646 0.3678972 2.1045455 4.326154  16.63  13.300684
    ## 11 lager        42.29646 0.2506673 1.0190909 3.806154  15.94   2.924895
    ## 12 lager        44.86283 0.1851995 2.1027273 4.009231  15.90   6.608789
    ## 13 lager        40.88053 0.2645550 1.0600000 3.716923  17.08   7.411211
    ## 14 lager        40.52655 0.2373837 1.7672727 4.033846  16.01  13.279053
    ## 15 lager        41.27876 0.3181808 1.3663636 3.756923  16.19   8.915368
    ## 16 lager        42.56195 0.2384425 0.7745455 3.526154  18.74   8.155895
    ## 17 lager        41.58850 0.2117667 1.4618182 3.587692  16.88   5.340684
    ## 18 lager        39.24336 0.1568371 0.6890909 3.636923  16.72   6.820842
    ## 19 lager        45.08407 0.2987997 1.3318182 4.206154  16.25  10.285842
    ## 20 lager        43.97788 0.2711778 1.4190909 3.849231  16.73   9.530947
    ## 21 stout        37.96018 0.2284018 1.5590909 3.950769  17.96   5.386316
    ## 22 stout        37.34071 0.2218108 1.6381818 3.855385  20.51   5.596842
    ## 23 stout        38.13717 0.2337934 4.7627273 4.147692  16.67   6.252105
    ## 24 stout        41.45575 0.2609931 1.3527273 3.978462  17.81   3.865789
    ## 25 stout        44.02212 0.1724107 2.1918182 4.033846  16.90   7.546947
    ## 26 stout        39.95133 0.2725868 5.2172727 4.412308  16.68   6.008368
    ## 27 stout        40.03982 0.3479189 2.8590909 4.178462  17.58   7.340842
    ## 28 stout        43.97788 0.2667703 3.7754545 4.347692  19.10   7.356000
    ## 29 stout        45.34956 0.2555296 1.3018182 4.160000  18.17   3.243579
    ## 30 stout        41.19027 0.2834026 2.6209091 4.123077  19.60   7.554947
    ##    colour degree_of_fermentation
    ## 1   13.44               55.33714
    ## 2   12.24               58.38000
    ## 3   10.92               58.38286
    ## 4   10.92               58.52571
    ## 5   10.56               58.90000
    ## 6   14.16               59.41429
    ## 7   12.96               60.01857
    ## 8   12.48               60.35571
    ## 9   12.60               60.46571
    ## 10  13.08               61.84571
    ## 11  12.60               37.03429
    ## 12  14.28               46.39857
    ## 13  15.24               47.32857
    ## 14  13.44               48.32857
    ## 15  15.36               50.07857
    ## 16   9.00               51.59714
    ## 17  14.76               52.15429
    ## 18  11.28               53.18857
    ## 19  14.76               53.38286
    ## 20  12.48               53.57429
    ## 21  10.68               71.69857
    ## 22   9.84               73.13714
    ## 23   6.84               73.39429
    ## 24   9.24               74.15714
    ## 25   7.32               74.67857
    ## 26   6.84               74.75714
    ## 27   8.88               74.88714
    ## 28   7.32               75.89429
    ## 29  10.68               76.18286
    ## 30   8.04               79.13429

1.  Apply a preprocessing technique to my data to get it ready for LDA:
    “center“: subtract mean from values. “scale“: divide values by
    standard deviation.

``` r
preproc.param <- beers_train %>% 
  preProcess(method = c("center", "scale"))
# Transform the data using the estimated parameters
train.transformed <- preproc.param %>% predict(beers_train)
test.transformed <- preproc.param %>% predict(beers_test)
```

``` r
train.transformed
```

    ##     style calorific_value    nitrogen   turbidity      alcohol
    ## 1     ale      1.39766656  1.01655822  0.06541696  0.914994066
    ## 2     ale      0.85802066  1.67882345  1.48820089  1.160656647
    ## 3     ale     -0.01890392  1.63342736 -0.32595054  1.381752975
    ## 4     ale      1.11097968  1.17024263  0.01445765  1.701114333
    ## 5     ale     -0.23813507  0.88557186  0.54545366  1.062391617
    ## 6     ale      0.43642230  0.28278591  0.03382219  0.693897739
    ## 7     ale      1.19529935  0.81225045 -0.80394886  0.878144676
    ## 8     ale      0.95920427  1.26759427  0.65552577  1.013259097
    ## 9     ale     -1.53665802  1.20859712  0.77986649  1.357186713
    ## 10    ale      1.60003378  1.47062060  0.03076463  0.927277195
    ## 11    ale      1.26275509  1.95570406  0.45474609  1.480018006
    ## 12    ale     -0.52482196  2.12765855  0.54647285  1.688831204
    ## 13    ale     -1.60411376  0.79216605  0.42824725  1.516867392
    ## 14    ale      1.07725181  0.30212175 -0.04975108  0.595632708
    ## 15    ale     -1.48606622  1.84477672 -0.22403192  1.713397462
    ## 16    ale      0.68938132  1.85912635  1.12537061  0.890427809
    ## 17    ale      0.01482394 -0.19888459 -0.04975108  1.504584263
    ## 18    ale      1.19529935  0.94715727 -0.28416390  1.492301134
    ## 19    ale      1.36393870  3.11398942  1.11517875  1.467734877
    ## 20    ale     -1.57038589  0.83836145 -0.05178945  0.693897739
    ## 21    ale      0.55446984  0.09728110 -0.11701737  0.792162774
    ## 22    ale      0.18346329  0.50957603 -0.54915231 -0.178204430
    ## 23    ale      0.92547640  0.97612297  0.29779142  1.086957874
    ## 24    ale      1.29648296  1.55437118 -0.11497899  1.308054198
    ## 25    ale     -0.54168589  1.35526531 -0.56444011  0.485084544
    ## 26    ale     -1.28369901  1.24148328 -0.26174181  0.067458151
    ## 27    ale      0.90861247  1.28375822  0.47207226  1.025542226
    ## 28    ale      1.06038788  0.44535161 -0.86204248  0.620198966
    ## 29    ale     -1.06446786  1.77849691  0.44557341  1.025542226
    ## 30    ale     -0.06949573  1.71613756  0.44047748  0.362253252
    ## 31    ale     -1.31742688  1.35502424  0.30696409  0.902710937
    ## 32    ale     -0.37304655  1.05413878 -0.75298955  0.632482095
    ## 33    ale     -0.89582852  1.69656065 -0.30862437  0.939560324
    ## 34    ale      1.24589116  1.13191351 -0.31779705  0.202572573
    ## 35    ale      0.75683706  0.19850246 -0.46252149 -0.079939399
    ## 36    ale      1.09411575  1.87688894  0.19281524  0.951843453
    ## 37    ale     -1.31742688  1.92148571  0.14083674  1.602849298
    ## 38    ale     -1.36801868  1.76937456  1.07135374  0.779879645
    ## 39    ale     -0.89582852  0.45449934 -0.60826511  1.074674745
    ## 40    ale     -1.11505966 -0.10313158 -0.23320459  0.300837608
    ## 41    ale     -1.40174655  0.55494675  0.31817514  0.349970123
    ## 42    ale      0.08227968 -0.07571377 -0.87121515  0.067458151
    ## 43  lager      0.11600755 -1.02971674 -0.50125056 -0.767794631
    ## 44  lager     -1.18251540 -0.48281187 -0.68164652 -0.485282659
    ## 45  lager      1.11097968 -0.76462287 -1.03122739 -1.443366734
    ## 46  lager      1.48198624 -0.98354670 -0.12109411 -0.436150144
    ## 47  lager      1.54944197 -1.36765496 -1.08422507 -0.952041568
    ## 48  lager     -0.65973343 -1.59414311 -1.21060416 -1.222270410
    ## 49  lager     -0.01890392  0.13955605 -0.43704183 -0.866059662
    ## 50  lager      0.14973542 -0.29491419 -0.16899586 -0.337885109
    ## 51  lager     -0.49109409 -0.92665569 -1.37876988 -0.374734496
    ## 52  lager      0.94234034 -0.85752118 -0.56749767 -0.399300757
    ## 53  lager     -0.55854983 -1.34023714 -1.30946522 -2.413733937
    ## 54  lager     -1.31742688 -1.13438149 -0.45538718 -0.694095854
    ## 55  lager      0.72310919 -1.02868143 -0.31270112  0.607915837
    ## 56  lager     -1.18251540 -0.26335009 -0.67247384 -0.816927146
    ## 57  lager     -1.01387606 -1.14769074 -1.75790714 -0.767794631
    ## 58  lager     -0.33931868 -1.57638561 -0.35550694 -1.689029319
    ## 59  lager      0.25091903 -1.44227810 -0.47882847 -0.706378983
    ## 60  lager     -1.43547442 -0.62160870 -1.32984894 -1.124005376
    ## 61  lager      1.07725181 -0.86560316 -1.34105999 -1.124005376
    ## 62  lager     -1.62097770 -1.08268730 -0.81617910 -1.025740341
    ## 63  lager      1.31334689  0.50171990 -1.13416519 -1.271402926
    ## 64  lager     -0.59227770 -1.16488492 -1.48476524 -0.362451367
    ## 65  lager      0.11600755  0.22589490 -1.21773846  0.423668900
    ## 66  lager     -0.08635967 -0.88752726 -1.00880529 -1.222270410
    ## 67  lager     -1.08133179 -0.28842070 -0.66533954 -1.173137891
    ## 68  lager      0.04855181 -1.32276129 -0.83044770 -1.381951090
    ## 69  lager     -1.03073999 -0.94310638 -1.23404544 -0.804644017
    ## 70  lager     -0.25499901 -0.56159654 -1.29723498 -1.897842513
    ## 71  lager      1.38080263 -1.36111578 -1.11480065 -1.124005376
    ## 72  lager      0.65565345 -0.07731240 -1.04345762 -1.664463057
    ## 73  lager     -0.08635967 -0.94963032 -1.22079602 -1.946975029
    ## 74  lager      0.43642230 -0.25788175 -1.35532860 -1.124005376
    ## 75  lager      0.65565345 -1.31702652 -0.71324129 -1.013457212
    ## 76  lager     -1.63784163 -0.41964305 -0.73566339 -0.767794631
    ## 77  lager     -0.82837278 -0.92038804 -1.38998093 -1.418800476
    ## 78  lager      0.53760591 -0.92276061 -0.70610699  1.062391617
    ## 79  lager     -1.73902524  0.54766409 -1.25646754 -0.006240622
    ## 80  lager     -0.65973343 -0.59683497 -0.78866107 -1.652179928
    ## 81  lager     -1.09819573 -0.53340478 -1.19429718 -1.701312448
    ## 82  lager     -0.77778098 -1.05166621 -1.12397333 -0.706378983
    ## 83  lager     -1.31742688 -0.93344607 -1.02918901 -1.480216120
    ## 84  lager      0.70624525 -0.47157831 -0.80700642 -1.455649863
    ## 85  lager     -1.35115475 -0.44992572 -0.14249702 -1.517065511
    ## 86  lager      1.54944197 -0.72653482  0.90013046 -1.762728092
    ## 87  stout     -1.51979409 -0.57463936  0.62189263 -0.509848917
    ## 88  stout     -1.14878753 -0.21037952  1.28130610 -0.485282659
    ## 89  stout     -1.60411376  0.27235674 -0.74483606  0.202572573
    ## 90  stout      1.12784361  0.53667666  0.70240834 -0.915192181
    ## 91  stout     -0.23813507 -0.40844501  0.17243151  0.607915837
    ## 92  stout      0.90861247 -1.12914914 -0.61336104  1.086957874
    ## 93  stout      0.53760591 -0.39772403  2.37896963 -0.215053816
    ## 94  stout      0.87488460 -0.50131795  0.66469845 -0.595830823
    ## 95  stout      1.06038788 -0.19682921  1.84389688  0.964126582
    ## 96  stout     -1.24997114 -0.29701018  2.68676386  0.288554479
    ## 97  stout      1.16157148 -1.01040627  1.09683339  0.902710937
    ## 98  stout      1.49885017 -1.13696467  2.38916108 -0.276469465
    ## 99  stout      1.06038788  0.07196942  1.89485619  0.337686994
    ## 100 stout      0.31837476 -0.18845542  1.17021480  0.214855702
    ## 101 stout      1.41453050 -0.31189269 -0.06503887 -0.165921301
    ## 102 stout     -0.27186294 -0.48438005 -0.23422378  0.767596516
    ## 103 stout     -0.60914163 -0.14226001 -0.19345633  0.448235158
    ## 104 stout      0.57133378 -0.86637710  0.84407522 -0.780077760
    ## 105 stout      0.41955837 -0.46531065  1.23646190  0.399102638
    ## 106 stout      0.87488460 -0.54361827  0.50570540 -0.976607825
    ## 107 stout      0.45328624 -0.86560316  1.53304509  1.037825355
    ## 108 stout      0.45328624 -0.06296277  0.56176064 -0.043090008
    ## 109 stout     -1.21624327 -0.68188730  0.50366703 -0.362451367
    ## 110 stout      1.16157148  0.09362709  2.01002423  0.214855702
    ## 111 stout     -0.18754327 -0.38105257 -0.13026679 -0.227336945
    ## 112 stout     -0.06949573 -0.44237155  1.29965145  0.104307542
    ## 113 stout      0.53760591 -1.05164084  2.45337022 -0.251903207
    ## 114 stout      0.84115673 -0.08147392  1.33532296  0.878144676
    ## 115 stout      0.14973542 -0.56500949 -0.35346856 -0.141355043
    ## 116 stout      1.26275509 -0.12817683  0.99287640  0.497367673
    ## 117 stout     -1.31742688 -0.43738534 -0.03446329  0.853578418
    ## 118 stout     -0.28872688 -0.21795399  2.08340563  1.430885490
    ## 119 stout     -1.57038589 -0.62760991  1.41583867 -0.153638172
    ## 120 stout     -0.22127114 -0.09008877 -0.46965579 -0.915192181
    ## 121 stout     -0.05263180 -0.34373846  0.41499783 -0.178204430
    ## 122 stout      0.79056493 -0.65894819  0.86140138  0.620198966
    ## 123 stout     -1.33429081  0.04767275  2.12417308  0.558783317
    ## 124 stout      0.33523870  0.22487989  1.20894388 -0.669529596
    ##           sugars  bitterness      colour degree_of_fermentation
    ## 1   -0.624659371  1.06246500 -0.09892468           -0.846871405
    ## 2   -0.570781957  1.76571032  0.74530518           -0.701162113
    ## 3   -0.795271182  0.85188846  0.95636264           -0.626845499
    ## 4    1.099417873  1.44571338  0.40761324           -0.616124414
    ## 5   -0.912005579  0.95050532  0.28097876           -0.579331599
    ## 6   -0.588741095  1.80072176  0.02770980           -0.551066921
    ## 7   -0.454047561  1.13667388  0.70309369           -0.530355734
    ## 8   -0.552822819  1.53147989  0.28097876           -0.258917349
    ## 9   -0.310374457  1.26526977  0.53424771           -0.224317484
    ## 10  -0.570781957  0.75088620  0.87193966           -0.114913684
    ## 11  -0.543843250  1.72208067  0.44982473           -0.067156123
    ## 12  -0.373231440  0.84317792 -0.35219363            0.070512357
    ## 13  -0.588741095  0.31489750  0.40761324            0.113640359
    ## 14  -0.498945406  0.21160219  0.40761324            0.128747342
    ## 15  -0.445067992  1.13353439  0.32319025            0.137519139
    ## 16  -0.840169027  1.40646978 -0.22555915            0.158230326
    ## 17   1.458600633  0.40449602 -0.22555915            0.218901922
    ## 18   1.503498478  1.28215221 -0.30998214            0.223044159
    ## 19  -0.696495923  1.04195060  1.20963160            0.261055278
    ## 20  -0.570781957  0.50739121  0.15434428            0.344387350
    ## 21   0.659418993  0.62627623  0.06992130            0.390682944
    ## 22  -0.687516354  0.38198097  0.61867070            0.479375558
    ## 23  -0.427108854  0.66039508 -0.26777065            0.523965527
    ## 24  -0.193640060  0.78589765  0.49203622            0.635562276
    ## 25  -0.534863681  1.40651595 -0.09892468            0.637755225
    ## 26  -0.642618509  0.29786116  0.74530518            0.656517124
    ## 27  -0.714455061  1.48491081  0.78751667            0.666994548
    ## 28  -0.498945406  0.13783961  0.74530518            0.737899907
    ## 29  -0.642618509  0.43612175  1.25184309            0.750326619
    ## 30  -0.355272302  0.45360439  0.53424771            0.923813270
    ## 31  -0.777312044  0.36400586  1.04078563            1.015917137
    ## 32  -0.507924975  1.06565066  0.66088219            1.029318494
    ## 33  -0.750373337 -0.08289410  1.29405458            1.035410019
    ## 34  -0.005069112  1.58611313  0.36540174            1.072690156
    ## 35   1.287988822  0.20278392  0.36540174            1.180388329
    ## 36  -0.418129285  1.05509336  0.78751667            1.201586839
    ## 37  -0.400170147  0.46436175  0.53424771            1.229851517
    ## 38  -0.498945406  1.04075021  1.42068906            1.454506984
    ## 39  -0.418129285  0.17175839  1.29405458            1.481309697
    ## 40   0.201460975  1.07217587  0.40761324            1.876771542
    ## 41  -0.651598078  0.67837019  0.61867070            1.972530325
    ## 42  -0.283435750  0.53986336  0.78751667            3.391124819
    ## 43  -1.073637820 -0.36892608  0.74530518           -2.298360137
    ## 44  -0.920985148 -0.61048198  0.40761324           -2.239394169
    ## 45  -0.804250751 -0.76228546  0.02770980           -2.151432538
    ## 46  -0.903026010 -0.68827665  0.15434428           -2.086375045
    ## 47  -0.965882993  0.39064534 -0.35219363           -2.079552536
    ## 48  -1.298127045 -0.42565232  1.84280399           -1.915325005
    ## 49  -0.678536785 -0.71860964 -0.15802077           -1.065191685
    ## 50  -0.498945406  0.92714383  0.91415115           -1.038145310
    ## 51  -0.750373337 -1.05847461  0.06992130           -0.947016087
    ## 52  -1.244249631 -0.19246839  1.20963160           -0.941655545
    ## 53  -0.768332475  0.24685987  3.23578325           -0.891948696
    ## 54  -0.750373337  1.42758438 -1.06978901           -0.886831815
    ## 55  -0.633638940 -0.49856847  0.15434428           -0.824698252
    ## 56  -1.136494803 -1.34769225  1.29405458           -0.781813912
    ## 57  -0.660577647  0.56222452 -0.22555915           -0.767681573
    ## 58  -0.337313164  0.66701263  0.91415115           -0.655110179
    ## 59   0.165542699  0.19396565 -0.35219363           -0.647556686
    ## 60  -0.929964717 -0.95602573  0.53424771           -0.636104619
    ## 61  -0.480986268 -1.11455449  0.57645921           -0.631718720
    ## 62  -0.678536785  0.18111530  1.63174652           -0.424363186
    ## 63  -1.145474372  0.72752472  0.19655577           -0.411936474
    ## 64   1.350845805  0.06806295  1.04078563           -0.229190705
    ## 65  -1.280167907 -0.88032406  0.32319025           -0.203849958
    ## 66  -0.768332475 -0.83330869  0.44982473           -0.180945822
    ## 67   1.736967271 -0.71865581 -0.64767408           -0.165351517
    ## 68   1.745946840  0.27231435 -0.81652005           -0.148538906
    ## 69   0.075747009  0.65416227 -0.60546259           -0.016230968
    ## 70   0.030849164  0.43950747 -0.60546259            0.033475881
    ## 71  -0.876087303  0.74037507 -0.05671318            0.070512357
    ## 72  -0.274456181 -0.83460142  0.23876727            0.120219206
    ## 73  -1.459759287 -0.31369264  0.66088219            0.270314398
    ## 74  -1.109556096 -1.16515565  1.54732354            0.301746670
    ## 75  -0.822209889  0.42017808  2.13828444            0.510807831
    ## 76  -1.037719545  0.06637009  1.04078563            0.527133119
    ## 77  -1.325065752  0.82175553 -0.64767408            0.604617326
    ## 78  -0.768332475  1.38016887  1.75838100            0.999591848
    ## 79  -0.624659371  0.82255579  1.54732354            1.003734086
    ## 80  -0.624659371 -0.75322096  1.75838100            1.027612867
    ## 81  -0.912005579  1.28065942  0.06992130            1.166986974
    ## 82   1.853701668  0.22599151 -0.09892468            1.241790908
    ## 83  -0.211599198  0.67966292  0.11213279            1.564641768
    ## 84  -0.220578767 -0.22255515  0.02770980            1.643587940
    ## 85   0.282277096 -0.40329116  1.20963160            2.399424442
    ## 86  -0.283435750  3.25398153 -0.05671318            3.427430311
    ## 87  -0.965882993 -1.67147504 -1.53411543           -1.693593471
    ## 88   0.084726578 -1.81441408 -0.90094304           -1.155102604
    ## 89   1.081458735 -1.34470666 -1.44969244           -1.097842262
    ## 90   1.359825374 -1.29011958 -1.23863498           -1.067384633
    ## 91   1.099417873 -0.68484476 -0.56325109           -0.889268424
    ## 92   2.401455376 -0.81174779 -1.53411543           -0.870750186
    ## 93   0.901867356 -0.53707337 -0.94315453           -0.796920896
    ## 94  -1.010780838 -1.08666845 -0.81652005           -0.773773097
    ## 95   0.354113648 -0.47277542 -1.02757751           -0.772554793
    ## 96   0.839010373 -1.42947284 -1.61853841           -0.733081706
    ## 97   1.790844685 -0.66312997 -0.68988557           -0.732594384
    ## 98   0.021869595 -0.78076843 -1.57632692           -0.718462045
    ## 99   1.719008133 -1.20241398 -1.49190393           -0.717974724
    ## 100  2.536148911 -1.48764570 -1.44969244           -0.592732955
    ## 101 -0.912005579 -1.34116704 -0.77430856           -0.592732955
    ## 102  2.320639255 -0.45633928 -0.14113617           -0.552041564
    ## 103  0.174522268 -1.57470494 -1.02757751           -0.517929020
    ## 104  1.314927529 -1.68646455 -1.61853841           -0.482110849
    ## 105  0.785132959 -1.10818317 -1.66074990           -0.457744747
    ## 106  0.596562010 -1.61454873 -1.19642348           -0.339325489
    ## 107  1.575335029 -0.53687330 -1.57632692           -0.326167793
    ## 108  0.973703908 -1.50114242 -1.11200050           -0.308380538
    ## 109  1.063499597 -0.01681096 -0.68988557           -0.291567928
    ## 110  0.201460975 -1.14991990 -1.44969244           -0.255262434
    ## 111 -0.049966956 -0.91678213 -1.19642348           -0.219444263
    ## 112  1.377784512  0.15541459 -1.57632692           -0.096639106
    ## 113  0.273297527 -0.88749563 -1.95623035           -0.006971850
    ## 114  2.949209084 -1.01330600 -1.28084647            0.001068965
    ## 115  0.560643734 -0.04485089 -0.85873154            0.063202525
    ## 116  1.386764081 -0.77867544 -1.02757751            0.173337310
    ## 117  0.803092097 -1.07401816  0.06992130            0.283959416
    ## 118  0.129624423 -1.42419419 -1.36526946            0.368266130
    ## 119  2.015333910 -1.51568564 -1.70296140            0.436491217
    ## 120  2.114109168 -0.94014362 -0.81652005            0.527620442
    ## 121  0.812071666 -1.37633239 -0.30998214            0.604617326
    ## 122  0.677378131 -0.77408932 -1.49190393            0.647501666
    ## 123  1.198193132 -0.33217560 -0.39440512            0.686974752
    ## 124  0.596562010 -0.65575833 -1.15421199            0.734732313

``` r
test.transformed
```

    ##    style calorific_value    nitrogen   turbidity     alcohol     sugars
    ## 1    ale      0.03168788  1.34038280  0.86242057  0.06745815 -0.5707820
    ## 2    ale      0.30151083  1.50505464 -0.09255690  0.37453638 -0.5797615
    ## 3    ale      1.61689771  0.89573460  0.86242057  1.11152413 -0.6156798
    ## 4    ale      1.39766656  1.10631002 -0.05892375  0.50965080  1.3239071
    ## 5    ale     -1.01387606  0.52259347  0.46391877  0.06745815 -0.5348637
    ## 6    ale     -0.18754327  0.54923734 -1.09135937  0.09202441 -0.7773120
    ## 7    ale      1.43139443  1.06560832  0.13676000  2.25385514 -0.6515981
    ## 8    ale     -1.28369901  1.11231123  0.26925420  1.25892168 -0.6156798
    ## 9    ale      0.72310919  0.84121615 -0.57870871  0.25170509 -0.5258841
    ## 10   ale     -1.65470556  0.33783723  0.27536932  1.30805420 -0.6605776
    ## 11 lager      0.25091903 -0.53030903 -0.94153900 -0.76779463 -1.2801679
    ## 12 lager      1.22902722 -1.01513112  0.27333095  0.04289189 -1.3160862
    ## 13 lager     -0.28872688 -0.42746366 -0.89567562 -1.12400538 -0.2564970
    ## 14 lager     -0.42363835 -0.62868075 -0.10274876  0.14115693 -1.2173109
    ## 15 lager     -0.13695147 -0.03033798 -0.55220987 -0.96432470 -1.0556787
    ## 16 lager      0.35210263 -0.62083983 -1.21570009 -1.88555938  1.2341114
    ## 17 lager     -0.01890392 -0.81838767 -0.44519532 -1.63989680 -0.4360884
    ## 18 lager     -0.91269245 -1.22516859 -1.31150359 -1.44336673 -0.5797615
    ## 19 lager      1.31334689 -0.17386473 -0.59093895  0.82901216 -1.0018013
    ## 20 lager      0.89174853 -0.37841863 -0.49309707 -0.59583082 -0.5707820
    ## 21 stout     -1.40174655 -0.69519654 -0.33614240 -0.19048756  0.5337050
    ## 22 stout     -1.63784163 -0.74400559 -0.24747320 -0.57126457  2.8234951
    ## 23 stout     -1.33429081 -0.65526880  3.25546976  0.59563271 -0.6246594
    ## 24 stout     -0.06949573 -0.45384110 -0.56749767 -0.07993940  0.3990115
    ## 25 stout      0.90861247 -1.10983867  0.37321119  0.14115693 -0.4181293
    ## 26 stout     -0.64286950 -0.36798439  3.76506286  1.65198181 -0.6156798
    ## 27 stout     -0.60914163  0.18988760  1.12129386  0.71846400  0.1924814
    ## 28 stout      0.89174853 -0.41105865  2.14863355  1.39403610  1.5573759
    ## 29 stout      1.41453050 -0.49430173 -0.62457209  0.64476522  0.7222760
    ## 30 stout     -0.17067934 -0.28788783  0.85426708  0.49736767  2.0063543
    ##      bitterness      colour degree_of_fermentation
    ## 1   0.443693455  0.74530518             -2.0137641
    ## 2   0.603561112  0.32319025             -1.4947661
    ## 3   1.321949840 -0.14113617             -1.4942788
    ## 4   0.078173947 -0.14113617             -1.4699126
    ## 5   0.152782956 -0.26777065             -1.4060735
    ## 6   1.196139474  0.99857413             -1.3183555
    ## 7   0.734850192  0.57645921             -1.2152869
    ## 8   0.992088144  0.40761324             -1.1577829
    ## 9   0.550820789  0.44982473             -1.1390210
    ## 10  1.276427264  0.61867070             -0.9036444
    ## 11 -1.757487776  0.44982473             -5.1355491
    ## 12 -0.680304813  1.04078563             -3.5383511
    ## 13 -0.445674253  1.37847757             -3.3797278
    ## 14  1.270102119  0.74530518             -3.2091651
    ## 15 -0.005853527  1.42068906             -2.9106803
    ## 16 -0.227926135 -0.81652005             -2.6516686
    ## 17 -1.051102972  1.20963160             -2.5566408
    ## 18 -0.618299925 -0.01450169             -2.3802302
    ## 19  0.394877497  1.20963160             -2.3470923
    ## 20  0.174143786  0.40761324             -2.3144418
    ## 21 -1.037760148 -0.22555915              0.7768857
    ## 22 -0.976201559 -0.52103960              1.0222523
    ## 23 -0.784600452 -1.57632692              1.0661113
    ## 24 -1.482367054 -0.73209707              1.1962263
    ## 25 -0.405984353 -1.40748095              1.2851626
    ## 26 -0.855869908 -1.57632692              1.2985639
    ## 27 -0.466250211 -0.85873154              1.3207371
    ## 28 -0.461817993 -1.40748095              1.4925181
    ## 29 -1.664303463 -0.22555915              1.5417376
    ## 30 -0.403645126 -1.15421199              2.0451413

1.  Fit the model to the transformed data and look at the predictions on
    the test set

``` r
# Fit the model
model <- lda(style~., data = train.transformed)
# Make predictions
predictions <- model %>% predict(test.transformed)
```

``` r
model
```

    ## Call:
    ## lda(style ~ ., data = train.transformed)
    ## 
    ## Prior probabilities of groups:
    ##       ale     lager     stout 
    ## 0.3387097 0.3548387 0.3064516 
    ## 
    ## Group means:
    ##       calorific_value   nitrogen   turbidity    alcohol     sugars
    ## ale        0.06300661  1.1381186  0.07514776  0.9155790 -0.3127262
    ## lager     -0.17182915 -0.7624341 -0.87739976 -0.9774453 -0.5003740
    ## stout      0.12932118 -0.3751021  0.93287851  0.1198231  0.9250252
    ##        bitterness     colour degree_of_fermentation
    ## ale    0.86329768  0.5000765              0.4972208
    ## lager  0.03597728  0.5031647             -0.1898339
    ## stout -0.99582903 -1.1353279             -0.3297522
    ## 
    ## Coefficients of linear discriminants:
    ##                                LD1         LD2
    ## calorific_value        -0.02880087  0.06814431
    ## nitrogen               -0.82797931  0.85051275
    ## turbidity               0.69967744  0.50491692
    ## alcohol                -0.31313101  0.94486221
    ## sugars                  0.33425179  0.23847579
    ## bitterness             -0.98852273 -0.31520076
    ## colour                 -0.58409941 -0.43812625
    ## degree_of_fermentation -0.06004528  0.29024988
    ## 
    ## Proportion of trace:
    ##    LD1    LD2 
    ## 0.5864 0.4136

``` r
plot(model)
```

![](LDA2_files/figure-gfm/unnamed-chunk-9-1.png)<!-- -->

1.  Linear discriminants are calculated by the prediction and are the
    result on dimensionality reduction on the feature attributes

``` r
# Predicted classes
(predictions$class)
```

    ##  [1] ale   ale   ale   ale   ale   ale   ale   ale   ale   ale   lager
    ## [12] lager lager lager lager lager lager lager lager lager stout stout
    ## [23] stout stout stout stout stout stout stout stout
    ## Levels: ale lager stout

``` r
# Predicted probabilities of class memebership.
(predictions$posterior) 
```

    ##             ale        lager        stout
    ## 1  9.819117e-01 1.796124e-02 1.271054e-04
    ## 2  9.990278e-01 9.709113e-04 1.254089e-06
    ## 3  9.998192e-01 1.688323e-04 1.192988e-05
    ## 4  9.872715e-01 3.068984e-03 9.659546e-03
    ## 5  4.877489e-01 4.474219e-01 6.482927e-02
    ## 6  6.840280e-01 3.159720e-01 1.414997e-08
    ## 7  9.999988e-01 1.071163e-06 9.405656e-08
    ## 8  9.998959e-01 1.034813e-04 5.879625e-07
    ## 9  9.631623e-01 3.683316e-02 4.562891e-06
    ## 10 9.968964e-01 3.101521e-03 2.125641e-06
    ## 11 8.770259e-08 9.998910e-01 1.089384e-04
    ## 12 9.858199e-06 9.994680e-01 5.221067e-04
    ## 13 8.216540e-07 9.999989e-01 3.075908e-07
    ## 14 7.647696e-04 9.992350e-01 1.833401e-07
    ## 15 3.887056e-05 9.999610e-01 1.061692e-07
    ## 16 1.025460e-07 9.997254e-01 2.744476e-04
    ## 17 2.208558e-08 9.999862e-01 1.381880e-05
    ## 18 1.029315e-08 9.999955e-01 4.532859e-06
    ## 19 2.075484e-01 7.924465e-01 5.034038e-06
    ## 20 1.831632e-04 9.997970e-01 1.983329e-05
    ## 21 2.086031e-04 9.635030e-02 9.034411e-01
    ## 22 7.290154e-07 1.044022e-03 9.989552e-01
    ## 23 1.470916e-09 1.892186e-09 1.000000e+00
    ## 24 8.006657e-05 3.605983e-03 9.963140e-01
    ## 25 3.460428e-05 2.409950e-03 9.975554e-01
    ## 26 5.524919e-09 8.179825e-12 1.000000e+00
    ## 27 3.003335e-03 2.709645e-05 9.969696e-01
    ## 28 4.103893e-07 9.796554e-10 9.999996e-01
    ## 29 4.914822e-04 6.295245e-04 9.988790e-01
    ## 30 1.986941e-05 1.371526e-06 9.999788e-01

``` r
# Linear discriminants
predictions$x
```

    ##           LD1         LD2
    ## 1  -1.4722301  0.45435867
    ## 2  -2.3263186  0.70381031
    ## 3  -1.8732618  1.42232086
    ## 4  -0.6211304  1.41424476
    ## 5  -0.1890016  0.20685697
    ## 6  -3.1881055 -1.39229030
    ## 7  -2.7415423  2.21017535
    ## 8  -2.4448764  1.20985256
    ## 9  -2.1156879 -0.11634284
    ## 10 -2.2386702  0.45634453
    ## 11  1.3685462 -3.07379507
    ## 12  0.8200548 -2.18351797
    ## 13 -0.1598831 -3.40311461
    ## 14 -1.4884061 -2.43070913
    ## 15 -1.0574725 -2.94228391
    ## 16  1.5176941 -2.94521920
    ## 17  1.2204069 -3.51632462
    ## 18  1.1438432 -3.75807777
    ## 19 -1.8577377 -1.14803552
    ## 20 -0.3328415 -2.11439380
    ## 21  1.7297782 -0.25781017
    ## 22  2.8206350  0.09690891
    ## 23  4.0957639  2.65670320
    ## 24  1.9602523  0.47754902
    ## 25  2.1161866  0.45772482
    ## 26  3.9232552  4.29564014
    ## 27  1.3674082  2.31744319
    ## 28  3.0910628  3.68002979
    ## 29  1.6554357  1.21298716
    ## 30  2.3062644  2.34978349

1.  Look at the resulting plot of LD1 vs LD2

``` r
predictions <- as.data.frame(predictions)

predictions
```

    ##    class posterior.ale posterior.lager posterior.stout      x.LD1
    ## 1    ale  9.819117e-01    1.796124e-02    1.271054e-04 -1.4722301
    ## 2    ale  9.990278e-01    9.709113e-04    1.254089e-06 -2.3263186
    ## 3    ale  9.998192e-01    1.688323e-04    1.192988e-05 -1.8732618
    ## 4    ale  9.872715e-01    3.068984e-03    9.659546e-03 -0.6211304
    ## 5    ale  4.877489e-01    4.474219e-01    6.482927e-02 -0.1890016
    ## 6    ale  6.840280e-01    3.159720e-01    1.414997e-08 -3.1881055
    ## 7    ale  9.999988e-01    1.071163e-06    9.405656e-08 -2.7415423
    ## 8    ale  9.998959e-01    1.034813e-04    5.879625e-07 -2.4448764
    ## 9    ale  9.631623e-01    3.683316e-02    4.562891e-06 -2.1156879
    ## 10   ale  9.968964e-01    3.101521e-03    2.125641e-06 -2.2386702
    ## 11 lager  8.770259e-08    9.998910e-01    1.089384e-04  1.3685462
    ## 12 lager  9.858199e-06    9.994680e-01    5.221067e-04  0.8200548
    ## 13 lager  8.216540e-07    9.999989e-01    3.075908e-07 -0.1598831
    ## 14 lager  7.647696e-04    9.992350e-01    1.833401e-07 -1.4884061
    ## 15 lager  3.887056e-05    9.999610e-01    1.061692e-07 -1.0574725
    ## 16 lager  1.025460e-07    9.997254e-01    2.744476e-04  1.5176941
    ## 17 lager  2.208558e-08    9.999862e-01    1.381880e-05  1.2204069
    ## 18 lager  1.029315e-08    9.999955e-01    4.532859e-06  1.1438432
    ## 19 lager  2.075484e-01    7.924465e-01    5.034038e-06 -1.8577377
    ## 20 lager  1.831632e-04    9.997970e-01    1.983329e-05 -0.3328415
    ## 21 stout  2.086031e-04    9.635030e-02    9.034411e-01  1.7297782
    ## 22 stout  7.290154e-07    1.044022e-03    9.989552e-01  2.8206350
    ## 23 stout  1.470916e-09    1.892186e-09    1.000000e+00  4.0957639
    ## 24 stout  8.006657e-05    3.605983e-03    9.963140e-01  1.9602523
    ## 25 stout  3.460428e-05    2.409950e-03    9.975554e-01  2.1161866
    ## 26 stout  5.524919e-09    8.179825e-12    1.000000e+00  3.9232552
    ## 27 stout  3.003335e-03    2.709645e-05    9.969696e-01  1.3674082
    ## 28 stout  4.103893e-07    9.796554e-10    9.999996e-01  3.0910628
    ## 29 stout  4.914822e-04    6.295245e-04    9.988790e-01  1.6554357
    ## 30 stout  1.986941e-05    1.371526e-06    9.999788e-01  2.3062644
    ##          x.LD2
    ## 1   0.45435867
    ## 2   0.70381031
    ## 3   1.42232086
    ## 4   1.41424476
    ## 5   0.20685697
    ## 6  -1.39229030
    ## 7   2.21017535
    ## 8   1.20985256
    ## 9  -0.11634284
    ## 10  0.45634453
    ## 11 -3.07379507
    ## 12 -2.18351797
    ## 13 -3.40311461
    ## 14 -2.43070913
    ## 15 -2.94228391
    ## 16 -2.94521920
    ## 17 -3.51632462
    ## 18 -3.75807777
    ## 19 -1.14803552
    ## 20 -2.11439380
    ## 21 -0.25781017
    ## 22  0.09690891
    ## 23  2.65670320
    ## 24  0.47754902
    ## 25  0.45772482
    ## 26  4.29564014
    ## 27  2.31744319
    ## 28  3.68002979
    ## 29  1.21298716
    ## 30  2.34978349

``` r
ggplot(predictions, aes(x=x.LD1,y=x.LD2,color=class)) +
  geom_point()
```

![](LDA2_files/figure-gfm/unnamed-chunk-11-1.png)<!-- -->

1.  Add LDA1 and LDA2 to our transformed training data

``` r
lda.data <- cbind(train.transformed, predict(model)$x)

lda.data
```

    ##     style calorific_value    nitrogen   turbidity      alcohol
    ## 1     ale      1.39766656  1.01655822  0.06541696  0.914994066
    ## 2     ale      0.85802066  1.67882345  1.48820089  1.160656647
    ## 3     ale     -0.01890392  1.63342736 -0.32595054  1.381752975
    ## 4     ale      1.11097968  1.17024263  0.01445765  1.701114333
    ## 5     ale     -0.23813507  0.88557186  0.54545366  1.062391617
    ## 6     ale      0.43642230  0.28278591  0.03382219  0.693897739
    ## 7     ale      1.19529935  0.81225045 -0.80394886  0.878144676
    ## 8     ale      0.95920427  1.26759427  0.65552577  1.013259097
    ## 9     ale     -1.53665802  1.20859712  0.77986649  1.357186713
    ## 10    ale      1.60003378  1.47062060  0.03076463  0.927277195
    ## 11    ale      1.26275509  1.95570406  0.45474609  1.480018006
    ## 12    ale     -0.52482196  2.12765855  0.54647285  1.688831204
    ## 13    ale     -1.60411376  0.79216605  0.42824725  1.516867392
    ## 14    ale      1.07725181  0.30212175 -0.04975108  0.595632708
    ## 15    ale     -1.48606622  1.84477672 -0.22403192  1.713397462
    ## 16    ale      0.68938132  1.85912635  1.12537061  0.890427809
    ## 17    ale      0.01482394 -0.19888459 -0.04975108  1.504584263
    ## 18    ale      1.19529935  0.94715727 -0.28416390  1.492301134
    ## 19    ale      1.36393870  3.11398942  1.11517875  1.467734877
    ## 20    ale     -1.57038589  0.83836145 -0.05178945  0.693897739
    ## 21    ale      0.55446984  0.09728110 -0.11701737  0.792162774
    ## 22    ale      0.18346329  0.50957603 -0.54915231 -0.178204430
    ## 23    ale      0.92547640  0.97612297  0.29779142  1.086957874
    ## 24    ale      1.29648296  1.55437118 -0.11497899  1.308054198
    ## 25    ale     -0.54168589  1.35526531 -0.56444011  0.485084544
    ## 26    ale     -1.28369901  1.24148328 -0.26174181  0.067458151
    ## 27    ale      0.90861247  1.28375822  0.47207226  1.025542226
    ## 28    ale      1.06038788  0.44535161 -0.86204248  0.620198966
    ## 29    ale     -1.06446786  1.77849691  0.44557341  1.025542226
    ## 30    ale     -0.06949573  1.71613756  0.44047748  0.362253252
    ## 31    ale     -1.31742688  1.35502424  0.30696409  0.902710937
    ## 32    ale     -0.37304655  1.05413878 -0.75298955  0.632482095
    ## 33    ale     -0.89582852  1.69656065 -0.30862437  0.939560324
    ## 34    ale      1.24589116  1.13191351 -0.31779705  0.202572573
    ## 35    ale      0.75683706  0.19850246 -0.46252149 -0.079939399
    ## 36    ale      1.09411575  1.87688894  0.19281524  0.951843453
    ## 37    ale     -1.31742688  1.92148571  0.14083674  1.602849298
    ## 38    ale     -1.36801868  1.76937456  1.07135374  0.779879645
    ## 39    ale     -0.89582852  0.45449934 -0.60826511  1.074674745
    ## 40    ale     -1.11505966 -0.10313158 -0.23320459  0.300837608
    ## 41    ale     -1.40174655  0.55494675  0.31817514  0.349970123
    ## 42    ale      0.08227968 -0.07571377 -0.87121515  0.067458151
    ## 43  lager      0.11600755 -1.02971674 -0.50125056 -0.767794631
    ## 44  lager     -1.18251540 -0.48281187 -0.68164652 -0.485282659
    ## 45  lager      1.11097968 -0.76462287 -1.03122739 -1.443366734
    ## 46  lager      1.48198624 -0.98354670 -0.12109411 -0.436150144
    ## 47  lager      1.54944197 -1.36765496 -1.08422507 -0.952041568
    ## 48  lager     -0.65973343 -1.59414311 -1.21060416 -1.222270410
    ## 49  lager     -0.01890392  0.13955605 -0.43704183 -0.866059662
    ## 50  lager      0.14973542 -0.29491419 -0.16899586 -0.337885109
    ## 51  lager     -0.49109409 -0.92665569 -1.37876988 -0.374734496
    ## 52  lager      0.94234034 -0.85752118 -0.56749767 -0.399300757
    ## 53  lager     -0.55854983 -1.34023714 -1.30946522 -2.413733937
    ## 54  lager     -1.31742688 -1.13438149 -0.45538718 -0.694095854
    ## 55  lager      0.72310919 -1.02868143 -0.31270112  0.607915837
    ## 56  lager     -1.18251540 -0.26335009 -0.67247384 -0.816927146
    ## 57  lager     -1.01387606 -1.14769074 -1.75790714 -0.767794631
    ## 58  lager     -0.33931868 -1.57638561 -0.35550694 -1.689029319
    ## 59  lager      0.25091903 -1.44227810 -0.47882847 -0.706378983
    ## 60  lager     -1.43547442 -0.62160870 -1.32984894 -1.124005376
    ## 61  lager      1.07725181 -0.86560316 -1.34105999 -1.124005376
    ## 62  lager     -1.62097770 -1.08268730 -0.81617910 -1.025740341
    ## 63  lager      1.31334689  0.50171990 -1.13416519 -1.271402926
    ## 64  lager     -0.59227770 -1.16488492 -1.48476524 -0.362451367
    ## 65  lager      0.11600755  0.22589490 -1.21773846  0.423668900
    ## 66  lager     -0.08635967 -0.88752726 -1.00880529 -1.222270410
    ## 67  lager     -1.08133179 -0.28842070 -0.66533954 -1.173137891
    ## 68  lager      0.04855181 -1.32276129 -0.83044770 -1.381951090
    ## 69  lager     -1.03073999 -0.94310638 -1.23404544 -0.804644017
    ## 70  lager     -0.25499901 -0.56159654 -1.29723498 -1.897842513
    ## 71  lager      1.38080263 -1.36111578 -1.11480065 -1.124005376
    ## 72  lager      0.65565345 -0.07731240 -1.04345762 -1.664463057
    ## 73  lager     -0.08635967 -0.94963032 -1.22079602 -1.946975029
    ## 74  lager      0.43642230 -0.25788175 -1.35532860 -1.124005376
    ## 75  lager      0.65565345 -1.31702652 -0.71324129 -1.013457212
    ## 76  lager     -1.63784163 -0.41964305 -0.73566339 -0.767794631
    ## 77  lager     -0.82837278 -0.92038804 -1.38998093 -1.418800476
    ## 78  lager      0.53760591 -0.92276061 -0.70610699  1.062391617
    ## 79  lager     -1.73902524  0.54766409 -1.25646754 -0.006240622
    ## 80  lager     -0.65973343 -0.59683497 -0.78866107 -1.652179928
    ## 81  lager     -1.09819573 -0.53340478 -1.19429718 -1.701312448
    ## 82  lager     -0.77778098 -1.05166621 -1.12397333 -0.706378983
    ## 83  lager     -1.31742688 -0.93344607 -1.02918901 -1.480216120
    ## 84  lager      0.70624525 -0.47157831 -0.80700642 -1.455649863
    ## 85  lager     -1.35115475 -0.44992572 -0.14249702 -1.517065511
    ## 86  lager      1.54944197 -0.72653482  0.90013046 -1.762728092
    ## 87  stout     -1.51979409 -0.57463936  0.62189263 -0.509848917
    ## 88  stout     -1.14878753 -0.21037952  1.28130610 -0.485282659
    ## 89  stout     -1.60411376  0.27235674 -0.74483606  0.202572573
    ## 90  stout      1.12784361  0.53667666  0.70240834 -0.915192181
    ## 91  stout     -0.23813507 -0.40844501  0.17243151  0.607915837
    ## 92  stout      0.90861247 -1.12914914 -0.61336104  1.086957874
    ## 93  stout      0.53760591 -0.39772403  2.37896963 -0.215053816
    ## 94  stout      0.87488460 -0.50131795  0.66469845 -0.595830823
    ## 95  stout      1.06038788 -0.19682921  1.84389688  0.964126582
    ## 96  stout     -1.24997114 -0.29701018  2.68676386  0.288554479
    ## 97  stout      1.16157148 -1.01040627  1.09683339  0.902710937
    ## 98  stout      1.49885017 -1.13696467  2.38916108 -0.276469465
    ## 99  stout      1.06038788  0.07196942  1.89485619  0.337686994
    ## 100 stout      0.31837476 -0.18845542  1.17021480  0.214855702
    ## 101 stout      1.41453050 -0.31189269 -0.06503887 -0.165921301
    ## 102 stout     -0.27186294 -0.48438005 -0.23422378  0.767596516
    ## 103 stout     -0.60914163 -0.14226001 -0.19345633  0.448235158
    ## 104 stout      0.57133378 -0.86637710  0.84407522 -0.780077760
    ## 105 stout      0.41955837 -0.46531065  1.23646190  0.399102638
    ## 106 stout      0.87488460 -0.54361827  0.50570540 -0.976607825
    ## 107 stout      0.45328624 -0.86560316  1.53304509  1.037825355
    ## 108 stout      0.45328624 -0.06296277  0.56176064 -0.043090008
    ## 109 stout     -1.21624327 -0.68188730  0.50366703 -0.362451367
    ## 110 stout      1.16157148  0.09362709  2.01002423  0.214855702
    ## 111 stout     -0.18754327 -0.38105257 -0.13026679 -0.227336945
    ## 112 stout     -0.06949573 -0.44237155  1.29965145  0.104307542
    ## 113 stout      0.53760591 -1.05164084  2.45337022 -0.251903207
    ## 114 stout      0.84115673 -0.08147392  1.33532296  0.878144676
    ## 115 stout      0.14973542 -0.56500949 -0.35346856 -0.141355043
    ## 116 stout      1.26275509 -0.12817683  0.99287640  0.497367673
    ## 117 stout     -1.31742688 -0.43738534 -0.03446329  0.853578418
    ## 118 stout     -0.28872688 -0.21795399  2.08340563  1.430885490
    ## 119 stout     -1.57038589 -0.62760991  1.41583867 -0.153638172
    ## 120 stout     -0.22127114 -0.09008877 -0.46965579 -0.915192181
    ## 121 stout     -0.05263180 -0.34373846  0.41499783 -0.178204430
    ## 122 stout      0.79056493 -0.65894819  0.86140138  0.620198966
    ## 123 stout     -1.33429081  0.04767275  2.12417308  0.558783317
    ## 124 stout      0.33523870  0.22487989  1.20894388 -0.669529596
    ##           sugars  bitterness      colour degree_of_fermentation
    ## 1   -0.624659371  1.06246500 -0.09892468           -0.846871405
    ## 2   -0.570781957  1.76571032  0.74530518           -0.701162113
    ## 3   -0.795271182  0.85188846  0.95636264           -0.626845499
    ## 4    1.099417873  1.44571338  0.40761324           -0.616124414
    ## 5   -0.912005579  0.95050532  0.28097876           -0.579331599
    ## 6   -0.588741095  1.80072176  0.02770980           -0.551066921
    ## 7   -0.454047561  1.13667388  0.70309369           -0.530355734
    ## 8   -0.552822819  1.53147989  0.28097876           -0.258917349
    ## 9   -0.310374457  1.26526977  0.53424771           -0.224317484
    ## 10  -0.570781957  0.75088620  0.87193966           -0.114913684
    ## 11  -0.543843250  1.72208067  0.44982473           -0.067156123
    ## 12  -0.373231440  0.84317792 -0.35219363            0.070512357
    ## 13  -0.588741095  0.31489750  0.40761324            0.113640359
    ## 14  -0.498945406  0.21160219  0.40761324            0.128747342
    ## 15  -0.445067992  1.13353439  0.32319025            0.137519139
    ## 16  -0.840169027  1.40646978 -0.22555915            0.158230326
    ## 17   1.458600633  0.40449602 -0.22555915            0.218901922
    ## 18   1.503498478  1.28215221 -0.30998214            0.223044159
    ## 19  -0.696495923  1.04195060  1.20963160            0.261055278
    ## 20  -0.570781957  0.50739121  0.15434428            0.344387350
    ## 21   0.659418993  0.62627623  0.06992130            0.390682944
    ## 22  -0.687516354  0.38198097  0.61867070            0.479375558
    ## 23  -0.427108854  0.66039508 -0.26777065            0.523965527
    ## 24  -0.193640060  0.78589765  0.49203622            0.635562276
    ## 25  -0.534863681  1.40651595 -0.09892468            0.637755225
    ## 26  -0.642618509  0.29786116  0.74530518            0.656517124
    ## 27  -0.714455061  1.48491081  0.78751667            0.666994548
    ## 28  -0.498945406  0.13783961  0.74530518            0.737899907
    ## 29  -0.642618509  0.43612175  1.25184309            0.750326619
    ## 30  -0.355272302  0.45360439  0.53424771            0.923813270
    ## 31  -0.777312044  0.36400586  1.04078563            1.015917137
    ## 32  -0.507924975  1.06565066  0.66088219            1.029318494
    ## 33  -0.750373337 -0.08289410  1.29405458            1.035410019
    ## 34  -0.005069112  1.58611313  0.36540174            1.072690156
    ## 35   1.287988822  0.20278392  0.36540174            1.180388329
    ## 36  -0.418129285  1.05509336  0.78751667            1.201586839
    ## 37  -0.400170147  0.46436175  0.53424771            1.229851517
    ## 38  -0.498945406  1.04075021  1.42068906            1.454506984
    ## 39  -0.418129285  0.17175839  1.29405458            1.481309697
    ## 40   0.201460975  1.07217587  0.40761324            1.876771542
    ## 41  -0.651598078  0.67837019  0.61867070            1.972530325
    ## 42  -0.283435750  0.53986336  0.78751667            3.391124819
    ## 43  -1.073637820 -0.36892608  0.74530518           -2.298360137
    ## 44  -0.920985148 -0.61048198  0.40761324           -2.239394169
    ## 45  -0.804250751 -0.76228546  0.02770980           -2.151432538
    ## 46  -0.903026010 -0.68827665  0.15434428           -2.086375045
    ## 47  -0.965882993  0.39064534 -0.35219363           -2.079552536
    ## 48  -1.298127045 -0.42565232  1.84280399           -1.915325005
    ## 49  -0.678536785 -0.71860964 -0.15802077           -1.065191685
    ## 50  -0.498945406  0.92714383  0.91415115           -1.038145310
    ## 51  -0.750373337 -1.05847461  0.06992130           -0.947016087
    ## 52  -1.244249631 -0.19246839  1.20963160           -0.941655545
    ## 53  -0.768332475  0.24685987  3.23578325           -0.891948696
    ## 54  -0.750373337  1.42758438 -1.06978901           -0.886831815
    ## 55  -0.633638940 -0.49856847  0.15434428           -0.824698252
    ## 56  -1.136494803 -1.34769225  1.29405458           -0.781813912
    ## 57  -0.660577647  0.56222452 -0.22555915           -0.767681573
    ## 58  -0.337313164  0.66701263  0.91415115           -0.655110179
    ## 59   0.165542699  0.19396565 -0.35219363           -0.647556686
    ## 60  -0.929964717 -0.95602573  0.53424771           -0.636104619
    ## 61  -0.480986268 -1.11455449  0.57645921           -0.631718720
    ## 62  -0.678536785  0.18111530  1.63174652           -0.424363186
    ## 63  -1.145474372  0.72752472  0.19655577           -0.411936474
    ## 64   1.350845805  0.06806295  1.04078563           -0.229190705
    ## 65  -1.280167907 -0.88032406  0.32319025           -0.203849958
    ## 66  -0.768332475 -0.83330869  0.44982473           -0.180945822
    ## 67   1.736967271 -0.71865581 -0.64767408           -0.165351517
    ## 68   1.745946840  0.27231435 -0.81652005           -0.148538906
    ## 69   0.075747009  0.65416227 -0.60546259           -0.016230968
    ## 70   0.030849164  0.43950747 -0.60546259            0.033475881
    ## 71  -0.876087303  0.74037507 -0.05671318            0.070512357
    ## 72  -0.274456181 -0.83460142  0.23876727            0.120219206
    ## 73  -1.459759287 -0.31369264  0.66088219            0.270314398
    ## 74  -1.109556096 -1.16515565  1.54732354            0.301746670
    ## 75  -0.822209889  0.42017808  2.13828444            0.510807831
    ## 76  -1.037719545  0.06637009  1.04078563            0.527133119
    ## 77  -1.325065752  0.82175553 -0.64767408            0.604617326
    ## 78  -0.768332475  1.38016887  1.75838100            0.999591848
    ## 79  -0.624659371  0.82255579  1.54732354            1.003734086
    ## 80  -0.624659371 -0.75322096  1.75838100            1.027612867
    ## 81  -0.912005579  1.28065942  0.06992130            1.166986974
    ## 82   1.853701668  0.22599151 -0.09892468            1.241790908
    ## 83  -0.211599198  0.67966292  0.11213279            1.564641768
    ## 84  -0.220578767 -0.22255515  0.02770980            1.643587940
    ## 85   0.282277096 -0.40329116  1.20963160            2.399424442
    ## 86  -0.283435750  3.25398153 -0.05671318            3.427430311
    ## 87  -0.965882993 -1.67147504 -1.53411543           -1.693593471
    ## 88   0.084726578 -1.81441408 -0.90094304           -1.155102604
    ## 89   1.081458735 -1.34470666 -1.44969244           -1.097842262
    ## 90   1.359825374 -1.29011958 -1.23863498           -1.067384633
    ## 91   1.099417873 -0.68484476 -0.56325109           -0.889268424
    ## 92   2.401455376 -0.81174779 -1.53411543           -0.870750186
    ## 93   0.901867356 -0.53707337 -0.94315453           -0.796920896
    ## 94  -1.010780838 -1.08666845 -0.81652005           -0.773773097
    ## 95   0.354113648 -0.47277542 -1.02757751           -0.772554793
    ## 96   0.839010373 -1.42947284 -1.61853841           -0.733081706
    ## 97   1.790844685 -0.66312997 -0.68988557           -0.732594384
    ## 98   0.021869595 -0.78076843 -1.57632692           -0.718462045
    ## 99   1.719008133 -1.20241398 -1.49190393           -0.717974724
    ## 100  2.536148911 -1.48764570 -1.44969244           -0.592732955
    ## 101 -0.912005579 -1.34116704 -0.77430856           -0.592732955
    ## 102  2.320639255 -0.45633928 -0.14113617           -0.552041564
    ## 103  0.174522268 -1.57470494 -1.02757751           -0.517929020
    ## 104  1.314927529 -1.68646455 -1.61853841           -0.482110849
    ## 105  0.785132959 -1.10818317 -1.66074990           -0.457744747
    ## 106  0.596562010 -1.61454873 -1.19642348           -0.339325489
    ## 107  1.575335029 -0.53687330 -1.57632692           -0.326167793
    ## 108  0.973703908 -1.50114242 -1.11200050           -0.308380538
    ## 109  1.063499597 -0.01681096 -0.68988557           -0.291567928
    ## 110  0.201460975 -1.14991990 -1.44969244           -0.255262434
    ## 111 -0.049966956 -0.91678213 -1.19642348           -0.219444263
    ## 112  1.377784512  0.15541459 -1.57632692           -0.096639106
    ## 113  0.273297527 -0.88749563 -1.95623035           -0.006971850
    ## 114  2.949209084 -1.01330600 -1.28084647            0.001068965
    ## 115  0.560643734 -0.04485089 -0.85873154            0.063202525
    ## 116  1.386764081 -0.77867544 -1.02757751            0.173337310
    ## 117  0.803092097 -1.07401816  0.06992130            0.283959416
    ## 118  0.129624423 -1.42419419 -1.36526946            0.368266130
    ## 119  2.015333910 -1.51568564 -1.70296140            0.436491217
    ## 120  2.114109168 -0.94014362 -0.81652005            0.527620442
    ## 121  0.812071666 -1.37633239 -0.30998214            0.604617326
    ## 122  0.677378131 -0.77408932 -1.49190393            0.647501666
    ## 123  1.198193132 -0.33217560 -0.39440512            0.686974752
    ## 124  0.596562010 -0.65575833 -1.15421199            0.734732313
    ##             LD1          LD2
    ## 1   -2.27311728  1.171093453
    ## 2   -3.06638034  2.111687477
    ## 3   -3.64153322  1.469832604
    ## 4   -2.78621925  2.134710256
    ## 5   -2.05117183  1.207838729
    ## 6   -2.40026497  0.062890997
    ## 7   -3.19865687  0.267541240
    ## 8   -2.78305146  1.619032292
    ## 9   -2.48883430  1.827328115
    ## 10  -2.96801210  1.463326603
    ## 11  -3.94372131  2.488356211
    ## 12  -2.64978429  3.465467743
    ## 13  -1.53802184  1.828637668
    ## 14  -1.12426142  0.541136930
    ## 15  -3.64422681  2.408434106
    ## 16  -2.59950444  2.538807717
    ## 17  -0.13540501  1.611064053
    ## 18  -2.08198302  2.308524438
    ## 19  -4.28194643  3.742591053
    ## 20  -1.70561814  0.971800953
    ## 21  -0.88941706  0.852537442
    ## 22  -1.75318034 -0.416025905
    ## 23  -1.63750086  2.030042446
    ## 24  -2.98153036  2.263240458
    ## 25  -3.20301610  0.946663239
    ## 26  -2.17920088  0.516882599
    ## 27  -3.28663871  1.571260966
    ## 28  -1.97930791  0.326983405
    ## 29  -2.87343950  2.012672546
    ## 30  -2.15883848  1.825913522
    ## 31  -2.44044925  1.609388357
    ## 32  -3.25798193  0.640736757
    ## 33  -2.87595840  1.694576989
    ## 34  -3.10631506  0.728652489
    ## 35  -0.53898946  0.337088341
    ## 36  -3.46356179  2.239041074
    ## 37  -2.93505919  3.011153763
    ## 38  -3.03294642  2.042174011
    ## 39  -2.26696849  0.742946675
    ## 40  -1.48317351  0.079041019
    ## 41  -1.67426793  0.800051440
    ## 42  -1.86238828 -0.033457305
    ## 43   0.44744944 -2.979819328
    ## 44   0.30085284 -2.149697663
    ## 45   0.92924342 -3.047196181
    ## 46   1.23718276 -1.880371233
    ## 47   0.24884414 -3.307370011
    ## 48  -0.09989204 -4.705637328
    ## 49   0.49021615 -1.096817850
    ## 50  -1.32746552 -1.758266407
    ## 51   0.74557793 -2.022653966
    ## 52  -0.46479872 -2.368284915
    ## 53  -1.37191786 -6.057376559
    ## 54  -0.10799381 -2.357960425
    ## 55   0.66217169 -0.710071504
    ## 56   0.28083305 -2.056104844
    ## 57  -0.60880931 -3.117014134
    ## 58   0.32841107 -4.020603297
    ## 59   1.18130574 -2.174084774
    ## 60   0.33786979 -2.699130224
    ## 61   0.74154140 -2.601265358
    ## 62  -0.64020265 -3.469570281
    ## 63  -2.04079819 -1.965908483
    ## 64  -0.15372285 -2.345087062
    ## 65  -0.90927850 -0.243092063
    ## 66   0.72928456 -2.595146820
    ## 67   1.85099912 -0.886871686
    ## 68   1.74575176 -2.201619438
    ## 69  -0.06762674 -2.183301802
    ## 70   0.08645035 -2.799408193
    ## 71  -0.33665167 -3.085443049
    ## 72   0.42284351 -1.992724523
    ## 73  -0.03583053 -3.729913494
    ## 74  -0.53637800 -2.423635988
    ## 75  -1.07992963 -3.510268025
    ## 76  -0.93172182 -2.136816432
    ## 77  -0.65557574 -2.997407424
    ## 78  -2.78640660 -1.199416982
    ## 79  -3.26650582 -1.087843327
    ## 80  -0.07428176 -2.895542193
    ## 81  -1.51132546 -3.052102634
    ## 82   0.70735255 -1.407799391
    ## 83  -0.34781738 -2.661620927
    ## 84   0.29267854 -1.653358837
    ## 85   0.42917683 -1.619212854
    ## 86  -1.74535214 -1.796976789
    ## 87   3.44154578 -0.282954844
    ## 88   3.67324231  0.582782420
    ## 89   1.83955475  0.935908506
    ## 90   2.81860824  0.987036140
    ## 91   1.70218966  0.764558217
    ## 92   2.69271045  1.066843664
    ## 93   3.47678249  1.262625236
    ## 94   2.30126252 -0.359496154
    ## 95   2.35297359  2.206276587
    ## 96   4.75434377  2.438449251
    ## 97   2.98896669  1.352251969
    ## 98   4.39941747  0.813648308
    ## 99   3.80764487  2.643476743
    ## 100  4.09900186  2.192106775
    ## 101  1.73274845  0.013961363
    ## 102  1.34701181  0.775372290
    ## 103  2.10589141  1.001184972
    ## 104  4.61669557  0.405535075
    ## 105  3.46876184  1.765538548
    ## 106  3.59916929  0.006711456
    ## 107  3.44889470  2.190206881
    ## 108  2.92303221  1.323321798
    ## 109  1.85808035 -0.274443339
    ## 110  3.29426751  2.348247393
    ## 111  1.90251184  0.120099311
    ## 112  2.47838134  1.315956033
    ## 113  4.76241125  1.342901577
    ## 114  3.43808562  3.076170804
    ## 115  0.98997421 -0.239963111
    ## 116  2.43177738  2.024966113
    ## 117  1.38092891  0.909170139
    ## 118  3.42495024  3.383757590
    ## 119  4.74402394  1.760068121
    ## 120  2.12017781  0.117810790
    ## 121  2.40901835  0.684002153
    ## 122  2.75548663  1.761478738
    ## 123  2.22820383  2.312761744
    ## 124  2.33736144  1.259818475

1.  Check that the resulting plot is the same as above

``` r
ggplot(lda.data, aes(LD1, LD2)) +
  geom_point(aes(color = style))
```

![](LDA2_files/figure-gfm/unnamed-chunk-13-1.png)<!-- -->

``` r
ggsave("LDA_OB.png")
```

    ## Saving 7 x 5 in image

1.  Use the model to give a score for the accuracy on the test data -
    100%

``` r
mean(predictions$class==test.transformed$style)
```

    ## [1] 1

1.  Look at the confusion matrix for the training & test data - note
    that it is 98% accurate while the test set is 100%

``` r
beers.train.lda.predict <- train(style ~ ., method = "lda", data = train.transformed)
confusionMatrix(train.transformed$style, predict(beers.train.lda.predict, train.transformed))
```

    ## Confusion Matrix and Statistics
    ## 
    ##           Reference
    ## Prediction ale lager stout
    ##      ale    42     0     0
    ##      lager   2    41     1
    ##      stout   0     0    38
    ## 
    ## Overall Statistics
    ##                                          
    ##                Accuracy : 0.9758         
    ##                  95% CI : (0.9309, 0.995)
    ##     No Information Rate : 0.3548         
    ##     P-Value [Acc > NIR] : < 2.2e-16      
    ##                                          
    ##                   Kappa : 0.9637         
    ##                                          
    ##  Mcnemar's Test P-Value : NA             
    ## 
    ## Statistics by Class:
    ## 
    ##                      Class: ale Class: lager Class: stout
    ## Sensitivity              0.9545       1.0000       0.9744
    ## Specificity              1.0000       0.9639       1.0000
    ## Pos Pred Value           1.0000       0.9318       1.0000
    ## Neg Pred Value           0.9756       1.0000       0.9884
    ## Prevalence               0.3548       0.3306       0.3145
    ## Detection Rate           0.3387       0.3306       0.3065
    ## Detection Prevalence     0.3387       0.3548       0.3065
    ## Balanced Accuracy        0.9773       0.9819       0.9872

``` r
beers.test.lda.predict <- train(style ~ ., method = "lda", data = beers_test)
confusionMatrix(beers_test$style, predict(beers.test.lda.predict, beers_test))
```

    ## Confusion Matrix and Statistics
    ## 
    ##           Reference
    ## Prediction ale lager stout
    ##      ale    10     0     0
    ##      lager   0    10     0
    ##      stout   0     0    10
    ## 
    ## Overall Statistics
    ##                                      
    ##                Accuracy : 1          
    ##                  95% CI : (0.8843, 1)
    ##     No Information Rate : 0.3333     
    ##     P-Value [Acc > NIR] : 4.857e-15  
    ##                                      
    ##                   Kappa : 1          
    ##                                      
    ##  Mcnemar's Test P-Value : NA         
    ## 
    ## Statistics by Class:
    ## 
    ##                      Class: ale Class: lager Class: stout
    ## Sensitivity              1.0000       1.0000       1.0000
    ## Specificity              1.0000       1.0000       1.0000
    ## Pos Pred Value           1.0000       1.0000       1.0000
    ## Neg Pred Value           1.0000       1.0000       1.0000
    ## Prevalence               0.3333       0.3333       0.3333
    ## Detection Rate           0.3333       0.3333       0.3333
    ## Detection Prevalence     0.3333       0.3333       0.3333
    ## Balanced Accuracy        1.0000       1.0000       1.0000

1.  Plot the boundaries computed by LDA to visually see where the
    mistakes were made in the training data

``` r
fit <- lda(style ~ ., data = train.transformed, prior = rep(1, 3)/3)
datPred <- data.frame(style=predict(fit)$class,predict(fit)$x)
#Create decision boundaries
fit2 <- lda(style ~ LD1 + LD2, data=datPred, prior = rep(1, 3)/3)
datPred <- datPred[-65,]
ld1lim <- expand_range(c(min(datPred$LD1),max(datPred$LD1)),mul=0.05)
ld2lim <- expand_range(c(min(datPred$LD2),max(datPred$LD2)),mul=0.05)
ld1 <- seq(ld1lim[[1]], ld1lim[[2]], length.out=300)
ld2 <- seq(ld2lim[[1]], ld1lim[[2]], length.out=300)
newdat <- expand.grid(list(LD1=ld1,LD2=ld2))
preds <-predict(fit2,newdata=newdat)
predclass <- preds$class
postprob <- preds$posterior
df <- data.frame(x=newdat$LD1, y=newdat$LD2, class=predclass)
df$classnum <- as.numeric(df$class)
df <- cbind(df,postprob)
```

``` r
colorfun <- function(n,l=65,c=100) { hues = seq(15, 375, length=n+1); hcl(h=hues, l=l, c=c)[1:n] } # default ggplot2 colours
colors <- colorfun(3)
colorslight <- colorfun(3,l=90,c=50)
ggplot(datPred, aes(x=LD1, y=LD2) ) +
    geom_raster(data=df, aes(x=x, y=y, fill = factor(class)),alpha=0.7,show_guide=FALSE) +
    geom_contour(data=df, aes(x=x, y=y, z=classnum), colour="red2", alpha=0.5, breaks=c(1.5,2.5)) +
    geom_point(data = datPred, size = 3, aes(colour=style)) +
    scale_x_continuous(limits = ld1lim, expand=c(0,0)) +
    scale_y_continuous(limits = ld2lim, expand=c(0,0)) +
    scale_fill_manual(values=colorslight,guide=F)
```

![](LDA2_files/figure-gfm/unnamed-chunk-18-1.png)<!-- -->

``` r
ggsave("LDA_OB1.png")
```

1.  Plot a similar graph for the test data

``` r
fit <- lda(style ~ ., data = test.transformed, prior = rep(1, 3)/3)
datPred <- data.frame(style=predict(fit)$class,predict(fit)$x)
#Create decision boundaries
fit2 <- lda(style ~ LD1 + LD2, data=datPred, prior = rep(1, 3)/3)
ld1lim <- expand_range(c(min(datPred$LD1),max(datPred$LD1)),mul=0.05)
ld2lim <- expand_range(c(min(datPred$LD2),max(datPred$LD2)),mul=0.05)
ld1 <- seq(ld1lim[[1]], ld1lim[[2]], length.out=300)
ld2 <- seq(ld2lim[[1]], ld1lim[[2]], length.out=300)
newdat <- expand.grid(list(LD1=ld1,LD2=ld2))
preds <-predict(fit2,newdata=newdat)
predclass <- preds$class
postprob <- preds$posterior
df <- data.frame(x=newdat$LD1, y=newdat$LD2, class=predclass)
df$classnum <- as.numeric(df$class)
df <- cbind(df,postprob)
datPred
```

    ##    style        LD1        LD2
    ## 1    ale -2.8530990  3.1577613
    ## 2    ale -1.8509325  4.5232157
    ## 3    ale -2.6856989  2.7388200
    ## 4    ale -1.2457266  2.7321449
    ## 5    ale -0.6183876  2.0761018
    ## 6    ale -2.7637474  2.3081922
    ## 7    ale -0.9957294  3.4553289
    ## 8    ale -0.8460303  4.2781295
    ## 9    ale -1.4419561  2.6943110
    ## 10   ale -0.7847103  2.3048732
    ## 11 lager -6.2918589 -2.5201079
    ## 12 lager -4.9039466 -4.1757194
    ## 13 lager -5.2607622 -2.2290151
    ## 14 lager -6.2891975 -1.4054984
    ## 15 lager -4.8863925 -0.8856314
    ## 16 lager -3.9171900 -1.8840988
    ## 17 lager -3.1552451 -3.7298043
    ## 18 lager -2.5703427 -3.0713014
    ## 19 lager -3.7993549 -0.7360399
    ## 20 lager -3.7379582 -1.4062665
    ## 21 stout  4.9526098 -1.1590140
    ## 22 stout  5.2421662 -1.6900392
    ## 23 stout  6.3315396 -1.3045908
    ## 24 stout  6.2516194 -0.5248131
    ## 25 stout  5.0315504 -2.0448128
    ## 26 stout  7.2667285 -0.5951065
    ## 27 stout  5.8550898  1.4099115
    ## 28 stout  6.2384356 -0.9758494
    ## 29 stout  6.8412371 -1.2400007
    ## 30 stout  6.8872903 -0.1010802

``` r
colorfun <- function(n,l=65,c=100) { hues = seq(15, 375, length=n+1); hcl(h=hues, l=l, c=c)[1:n] } # default ggplot2 colours
colors <- colorfun(3)
colorslight <- colorfun(3,l=90,c=50)
ggplot(datPred, aes(x=LD1, y=LD2) ) +
    geom_raster(data=df, aes(x=x, y=y, fill = factor(class)),alpha=0.7,show_guide=FALSE) +
    geom_contour(data=df, aes(x=x, y=y, z=classnum), colour="red2", alpha=0.5, breaks=c(1.5,2.5)) +
    geom_point(data = datPred, size = 3, aes(colour=style)) +
    scale_x_continuous(limits = ld1lim, expand=c(0,0)) +
    scale_y_continuous(limits = ld2lim, expand=c(0,0)) +
    scale_fill_manual(values=colorslight,guide=F)
```

![](LDA2_files/figure-gfm/unnamed-chunk-20-1.png)<!-- -->

``` r
ggsave("LDA_TEST_OB.png")
```
